<link rel="import" href="../polymer/polymer-element.html">

<dom-module id="owc-core-i18n">
  <template>
    <style>
      :host {
        display: block;
      }

      .container {
        width: 200px;
      }
    </style>
    <div class="container">
      <h3>Hello [[componentName]]!</h3>

      <!-- test button -->
      <button on-click="test">check dictionaries</button>
    </div>
  </template>

  <script>
    /**
     * `owc-core-i18n`
     * i18n manager component
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class OwcCoreI18n extends Polymer.Element {
      static get is() {
        return 'owc-core-i18n';
      }
      static get properties() {
        return {
          componentName: {
            type: String,
            value: 'owc-core-i18n'
          },
          //Dictionaries
          dictionaries: {
            type: String,
            value: [
              { //english
                en: {
                  type: String,
                  value: [
                    //default english dictionary here...
                  ]
                }
              },
              { //italian
                it: {
                  type: String,
                  value: [
                    //default italian dictionary here...
                  ]
                }
              },
              { //spanish
                es: {
                  type: String,
                  value: [
                    //default spanish dictionary here...
                  ]
                }
              }
            ]
          }
        };
      }

      constructor() {
        super();
        var self = this;
      }

      ready() {
        super.ready();
        var self = this;
      }

      /**
      *   Append a json object to a given dictionary
      * @param language: language to append json to
      * @param k : key value. NOTE: it will be converted to the string param
      * @param v : value
      */
      appendJson(language, k, v) {
        var self = this;
        var dict = self.dictionaries;

        //Create json object to assign a string value to key
        var jsonObject = {};
        jsonObject[k] = v; //Assign string value to key

        switch (language) {
          case "en":
            dict[0].en.value.push(jsonObject);
            break;
          case "it":
            dict[1].it.value.push(jsonObject);
            break;
          case "es":
            dict[2].es.value.push(jsonObject);
            break;
          default:
            console.log("ERROR, language not recognized!");
        }
      }

      /**
      *   Load language from server
      *
      * @param {?Object} paramExample: method parameter sample
      * @return {null}
      */
      _getLanguage(lang) {
        var self = this;
        return self._ctx.httpm.sendRequest(
          // 'GET',
          // self.owcApp.config.clientUrl + '/lang/dictionary.' + lang
        );
      }

      // check dictionaries
      test() {
        var self = this;
        var dic = JSON.stringify(self.dictionaries);
        console.log(dic);
      }

      /**
      *   Set the current language
      *
      * @param {?Object} newValue: the new value of public Property
      * @return {null}
      */
      setCurrentLanguage(lang) {
        var self = this;

        // if (!this.languages || this.languages[lang] === undefined) {
        //   return this._getLanguage(lang)
        //     .then(function (response) {
        //       if (response.status == 200) {
        //         self.languages[lang] = response.data;
        //         self.currentLanguage = lang;
        //         localStorage.setItem("owcLanguage", lang);
        //       }
        //     });
        // } else {
        //   self.currentLanguage = lang;
        //   localStorage.setItem("owcLanguage", lang);
        //   return null;
        // }
      }

      /**
       *   Translate a string
       *
       * @param {?Object} newValue: the new value of public Property
       * @return {String} translated string
       */
      translate(key) {
        // if ((this.languages[this.currentLanguage] === undefined)) return key;
        // return this.languages[this.currentLanguage][key] ? this.languages[this.currentLanguage][key] : key;
      }
    }

    window.customElements.define(OwcCoreI18n.is, OwcCoreI18n);
  </script>
</dom-module>